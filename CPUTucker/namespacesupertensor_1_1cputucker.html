<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CPUTucker: supertensor::cputucker Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CPUTucker
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('namespacesupertensor_1_1cputucker.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">supertensor::cputucker Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesupertensor_1_1cputucker_1_1constants.html">constants</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsupertensor_1_1cputucker_1_1_block.html">Block</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classsupertensor_1_1cputucker_1_1_block.html" title="The Block class represents a subtensor of a tensor.">Block</a> class represents a subtensor of a tensor.  <a href="classsupertensor_1_1cputucker_1_1_block.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsupertensor_1_1cputucker_1_1_config.html">Config</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages configuration settings.  <a href="classsupertensor_1_1cputucker_1_1_config.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsupertensor_1_1cputucker_1_1_optimizer.html">Optimizer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsupertensor_1_1cputucker_1_1_scheduler.html">Scheduler</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsupertensor_1_1cputucker_1_1_tensor.html">Tensor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor.html" title="The Tensor class represents a tensor.">Tensor</a> class represents a tensor.  <a href="classsupertensor_1_1cputucker_1_1_tensor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html" title="The TensorManager class manages tensor data and performs I/O operations.">TensorManager</a> class manages tensor data and performs I/O operations.  <a href="classsupertensor_1_1cputucker_1_1_tensor_manager.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1e96463d70a5832a80916c8e1a43fcb8" id="r_a1e96463d70a5832a80916c8e1a43fcb8"><td class="memTemplParams" colspan="2">template&lt;typename TensorType , typename ValueType , typename SchedulerType , typename TensorManagerType &gt; </td></tr>
<tr class="memitem:a1e96463d70a5832a80916c8e1a43fcb8"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a1e96463d70a5832a80916c8e1a43fcb8">ComputingDelta</a> (TensorType *tensor, TensorType *core_tensor, ValueType ***factor_matrices, int curr_factor_id, int rank, SchedulerType *scheduler, TensorManagerType *manager)</td></tr>
<tr class="memdesc:a1e96463d70a5832a80916c8e1a43fcb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the delta vectors used in the row-wise update rule for the update of the factor matrices.  <br /></td></tr>
<tr class="separator:a1e96463d70a5832a80916c8e1a43fcb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a027eca2b24114e52ec0847c7050be5bf" id="r_a027eca2b24114e52ec0847c7050be5bf"><td class="memTemplParams" colspan="2">template&lt;typename TensorType , typename MatrixType , typename ErrorType , typename SchedulerType , typename TensorManagerType &gt; </td></tr>
<tr class="memitem:a027eca2b24114e52ec0847c7050be5bf"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a027eca2b24114e52ec0847c7050be5bf">ComputingReconstruction</a> (TensorType *tensor, TensorType *core_tensor, MatrixType ***factor_matrices, ErrorType **error_T, int rank, SchedulerType *scheduler, TensorManagerType *manager)</td></tr>
<tr class="separator:a027eca2b24114e52ec0847c7050be5bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec436457e7a60d0ed32997d46c33d069" id="r_aec436457e7a60d0ed32997d46c33d069"><td class="memTemplParams" colspan="2">template&lt;typename TensorType , typename MatrixType , typename ErrorType , typename SchedulerType , typename <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> &gt; </td></tr>
<tr class="memitem:aec436457e7a60d0ed32997d46c33d069"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#aec436457e7a60d0ed32997d46c33d069">Reconstruction</a> (TensorType *tensor, TensorType *core_tensor, MatrixType ***factor_matrices, double *fit, ErrorType **error_T, int rank, SchedulerType *scheduler, <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> *manager)</td></tr>
<tr class="memdesc:aec436457e7a60d0ed32997d46c33d069"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the reconstruction of the original tensor from the core tensor and factor matrices, and calculates the reconstruction error.  <br /></td></tr>
<tr class="separator:aec436457e7a60d0ed32997d46c33d069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e33e4c6dadc4f66a05fd5696b5ee7ad" id="r_a9e33e4c6dadc4f66a05fd5696b5ee7ad"><td class="memTemplParams" colspan="2">template&lt;typename TensorType , typename OptimizerType , typename SchedulerType , typename TensorManagerType &gt; </td></tr>
<tr class="memitem:a9e33e4c6dadc4f66a05fd5696b5ee7ad"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a9e33e4c6dadc4f66a05fd5696b5ee7ad">TuckerDecomposition</a> (TensorType *tensor, OptimizerType *optimizer, SchedulerType *scheduler, TensorManagerType *manager)</td></tr>
<tr class="memdesc:a9e33e4c6dadc4f66a05fd5696b5ee7ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs Tucker decomposition on the provided tensor.  <br /></td></tr>
<tr class="separator:a9e33e4c6dadc4f66a05fd5696b5ee7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15afd65e836da4dd14f4e6aca6587a5" id="r_af15afd65e836da4dd14f4e6aca6587a5"><td class="memTemplParams" colspan="2">template&lt;typename TensorType , typename MatrixType , typename <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> &gt; </td></tr>
<tr class="memitem:af15afd65e836da4dd14f4e6aca6587a5"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#af15afd65e836da4dd14f4e6aca6587a5">ComputingBC</a> (TensorType *tensor, MatrixType **B, MatrixType **C, int curr_factor_id, int rank, <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> *manager)</td></tr>
<tr class="memdesc:af15afd65e836da4dd14f4e6aca6587a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the B matrices and C vectors used in the row-wise update rule for the update of the factor matrices.  <br /></td></tr>
<tr class="separator:af15afd65e836da4dd14f4e6aca6587a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a961d8373cec8a3b70e61251f368b980b" id="r_a961d8373cec8a3b70e61251f368b980b"><td class="memTemplParams" colspan="2">template&lt;typename TensorType , typename MatrixType , typename ValueType , typename SchedulerType , typename <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> &gt; </td></tr>
<tr class="memitem:a961d8373cec8a3b70e61251f368b980b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a961d8373cec8a3b70e61251f368b980b">UpdateFactorMatrices</a> (TensorType *tensor, TensorType *core_tensor, ValueType ***factor_matrices, MatrixType **B, MatrixType **C, int rank, SchedulerType *scheduler, <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> *manager)</td></tr>
<tr class="memdesc:a961d8373cec8a3b70e61251f368b980b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the factor matrices using row-wise update rule in Tucker decomposition.  <br /></td></tr>
<tr class="separator:a961d8373cec8a3b70e61251f368b980b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="af15afd65e836da4dd14f4e6aca6587a5" name="af15afd65e836da4dd14f4e6aca6587a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15afd65e836da4dd14f4e6aca6587a5">&#9670;&#160;</a></span>ComputingBC()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TensorType , typename MatrixType , typename <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void supertensor::cputucker::ComputingBC </td>
          <td>(</td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType **</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType **</td>          <td class="paramname"><span class="paramname"><em>C</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>curr_factor_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rank</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> *</td>          <td class="paramname"><span class="paramname"><em>manager</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the B matrices and C vectors used in the row-wise update rule for the update of the factor matrices. </p>
<p>This function calculates the B matrices and C vectors, which are used in the row-wise update rule to update the factor matrices in Tucker decomposition. The B matrix represents the product of delta matrices, and the C vector represents the product of delta matrices and the original tensor values.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TensorType</td><td>The type representing the tensor, typically a multi-dimensional array with additional properties. </td></tr>
    <tr><td class="paramname">MatrixType</td><td>The type representing the matrix, used for the B and C matrices. </td></tr>
    <tr><td class="paramname"><a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html" title="The TensorManager class manages tensor data and performs I/O operations.">TensorManager</a></td><td>The type of the manager responsible for I/O operations, such as reading/writing factor matrices and handling intermediate data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>Pointer to the tensor object for which the B and C matrices are being computed. </td></tr>
    <tr><td class="paramname">B</td><td>Pointer to the B matrices array. </td></tr>
    <tr><td class="paramname">C</td><td>Pointer to the C vectors array. </td></tr>
    <tr><td class="paramname">curr_factor_id</td><td>The current processing axis (mode) for which the B and C matrices are being computed. </td></tr>
    <tr><td class="paramname">rank</td><td>The rank used in the decomposition, determining size of B and C matrices. </td></tr>
    <tr><td class="paramname">manager</td><td>Pointer to the tensor manager object responsible for managing tensor-related I/O operations, such as reading blocks and delta values from files.</td></tr>
  </table>
  </dd>
</dl>
<p>The function begins by initializing the B and C matrices with appropriate values. It then iterates over each block of the tensor, reading the necessary data from files and calculating the B and C matrices for the current factor mode. The B vector is computed using the delta vectors, and the C matrix is computed using the delta vectors with the tensor values.</p>
<p>OpenMP is used to parallelize the computation, ensuring efficient processing even for large tensors. </p>

<p class="definition">Definition at line <a class="el" href="update_8hpp_source.html#l00042">42</a> of file <a class="el" href="update_8hpp_source.html">update.hpp</a>.</p>

</div>
</div>
<a id="a1e96463d70a5832a80916c8e1a43fcb8" name="a1e96463d70a5832a80916c8e1a43fcb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e96463d70a5832a80916c8e1a43fcb8">&#9670;&#160;</a></span>ComputingDelta()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TensorType , typename ValueType , typename SchedulerType , typename TensorManagerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void supertensor::cputucker::ComputingDelta </td>
          <td>(</td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>core_tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ValueType ***</td>          <td class="paramname"><span class="paramname"><em>factor_matrices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>curr_factor_id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rank</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SchedulerType *</td>          <td class="paramname"><span class="paramname"><em>scheduler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorManagerType *</td>          <td class="paramname"><span class="paramname"><em>manager</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the delta vectors used in the row-wise update rule for the update of the factor matrices. </p>
<p>This function calculates the delta vectors, which is an intermediate data used in the row-wise update step of the Tucker decomposition. The delta vectors are computed by multiplying the core tensor with the factor matrices along all modes except the current one (<code>curr_factor_id</code>). The results are stored and then written to a file for later use in updating the factor matrices.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TensorType</td><td>The type representing the tensor, typically a multi-dimensional array with additional properties. </td></tr>
    <tr><td class="paramname">ValueType</td><td>The data type used for the values in the tensor and the delta vectors. e.g., float, double). </td></tr>
    <tr><td class="paramname">SchedulerType</td><td>The type of the scheduler used to manage task distribution and parallel execution. </td></tr>
    <tr><td class="paramname">TensorManagerType</td><td>The type of the manager responsible for I/O operations related to the tensor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>Pointer to the original tensor object being decomposed. </td></tr>
    <tr><td class="paramname">core_tensor</td><td>Pointer to the core tensor obtained from Tucker decomposition. </td></tr>
    <tr><td class="paramname">factor_matrices</td><td>A 3D array of factor matrices used in the decomposition process. Each matrix corresponds to a partition of a mode (dimension) of the tensor. </td></tr>
    <tr><td class="paramname">curr_factor_id</td><td>The index of the current factor matrix being updated. This determines which mode is excluded from the computation. </td></tr>
    <tr><td class="paramname">rank</td><td>The rank used in the decomposition, which determines the size of the core tensor. </td></tr>
    <tr><td class="paramname">scheduler</td><td>Pointer to the scheduler object that manages the order and distribution of tasks (blocks) during the computation. </td></tr>
    <tr><td class="paramname">manager</td><td>Pointer to the tensor manager object responsible for reading and writing tensor data and managing memory.</td></tr>
  </table>
  </dd>
</dl>
<ol type="1">
<li><b>Delta Computation</b>: The delta tensor is computed for each non-zero element in the block. This involves multiplying the core tensor's values by the appropriate factor matrices, excluding the current factor matrix (<code>curr_factor_id</code>). The resulting delta tensor is stored in <code>curr_delta</code>.</li>
<li><b>Parallelization and SIMD Optimization</b>: The function uses OpenMP for parallel processing and, if available, utilizes AVX (Advanced Vector Extensions) instructions to accelerate the computation. </li>
</ol>

<p class="definition">Definition at line <a class="el" href="delta_8hpp_source.html#l00036">36</a> of file <a class="el" href="delta_8hpp_source.html">delta.hpp</a>.</p>

</div>
</div>
<a id="a027eca2b24114e52ec0847c7050be5bf" name="a027eca2b24114e52ec0847c7050be5bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a027eca2b24114e52ec0847c7050be5bf">&#9670;&#160;</a></span>ComputingReconstruction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TensorType , typename MatrixType , typename ErrorType , typename SchedulerType , typename TensorManagerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void supertensor::cputucker::ComputingReconstruction </td>
          <td>(</td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>core_tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType ***</td>          <td class="paramname"><span class="paramname"><em>factor_matrices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ErrorType **</td>          <td class="paramname"><span class="paramname"><em>error_T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rank</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SchedulerType *</td>          <td class="paramname"><span class="paramname"><em>scheduler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorManagerType *</td>          <td class="paramname"><span class="paramname"><em>manager</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="reconstruction_8hpp_source.html#l00013">13</a> of file <a class="el" href="reconstruction_8hpp_source.html">reconstruction.hpp</a>.</p>

</div>
</div>
<a id="aec436457e7a60d0ed32997d46c33d069" name="aec436457e7a60d0ed32997d46c33d069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec436457e7a60d0ed32997d46c33d069">&#9670;&#160;</a></span>Reconstruction()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TensorType , typename MatrixType , typename ErrorType , typename SchedulerType , typename <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void supertensor::cputucker::Reconstruction </td>
          <td>(</td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>core_tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType ***</td>          <td class="paramname"><span class="paramname"><em>factor_matrices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>fit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ErrorType **</td>          <td class="paramname"><span class="paramname"><em>error_T</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rank</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SchedulerType *</td>          <td class="paramname"><span class="paramname"><em>scheduler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> *</td>          <td class="paramname"><span class="paramname"><em>manager</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the reconstruction of the original tensor from the core tensor and factor matrices, and calculates the reconstruction error. </p>
<p>This function reconstructs the original tensor by using the core tensor and factor matrices obtained from Tucker decomposition. It computes the approximation of the original tensor and evaluates the reconstruction error. The error is then used to calculate the fitness of the decomposition, indicating how well the decomposition represents the original tensor.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">ErrorType</td><td>The type used for storing the error values during reconstruction.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>Pointer to the original tensor object that is being reconstructed. </td></tr>
    <tr><td class="paramname">core_tensor</td><td>Pointer to the core tensor obtained from Tucker decomposition. </td></tr>
    <tr><td class="paramname">factor_matrices</td><td>A 3D array of factor matrices used in the reconstruction process. Each matrix corresponds to a partition of a mode (dimension) of the tensor. </td></tr>
    <tr><td class="paramname">fit</td><td>Pointer to a double that will store the fitness value of the reconstruction. </td></tr>
    <tr><td class="paramname">error_T</td><td>A 2D array used to store the reconstruction error for each non-zero element in each block. </td></tr>
    <tr><td class="paramname">rank</td><td>The rank used in the decomposition, which determines the size of the core tensor. </td></tr>
    <tr><td class="paramname">scheduler</td><td>Pointer to the scheduler object that manages the order and distribution of tasks (blocks) during the reconstruction. </td></tr>
    <tr><td class="paramname">manager</td><td>Pointer to the tensor manager object responsible for reading and writing tensor data and managing memory.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>Reconstruction</code> function operates in the following steps:</p>
<ol type="1">
<li><b>Computing Reconstruction</b>: It first calls the <code>ComputingReconstruction</code> function, which performs the actual computation to approximate the original tensor using the core tensor and factor matrices. The results are stored in <code>error_T</code>.</li>
<li><b>Error Calculation</b>: After computing the reconstruction, the function calculates the squared error between the original tensor's values and the reconstructed values. This step is critical as it determines the accuracy of the decomposition.</li>
<li><b>Fitness Calculation</b>: Finally, the function calculates the fitness of the reconstruction. The fitness value is a measure of how well the reconstructed tensor matches the original tensor, with a value close to 1 indicating a good approximation.</li>
</ol>
<p>The function uses parallel processing with OpenMP to efficiently handle large tensors, and AVX (Advanced Vector Extensions) instructions are employed to speed up calculations when available. </p>

<p class="definition">Definition at line <a class="el" href="reconstruction_8hpp_source.html#l00184">184</a> of file <a class="el" href="reconstruction_8hpp_source.html">reconstruction.hpp</a>.</p>

</div>
</div>
<a id="a9e33e4c6dadc4f66a05fd5696b5ee7ad" name="a9e33e4c6dadc4f66a05fd5696b5ee7ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e33e4c6dadc4f66a05fd5696b5ee7ad">&#9670;&#160;</a></span>TuckerDecomposition()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TensorType , typename OptimizerType , typename SchedulerType , typename TensorManagerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void supertensor::cputucker::TuckerDecomposition </td>
          <td>(</td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OptimizerType *</td>          <td class="paramname"><span class="paramname"><em>optimizer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SchedulerType *</td>          <td class="paramname"><span class="paramname"><em>scheduler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorManagerType *</td>          <td class="paramname"><span class="paramname"><em>manager</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs Tucker decomposition on the provided tensor. </p>
<p>This function implements the Tucker decomposition algorithm, decomposing a given tensor into a core tensor and a set of factor matrices. The decomposition is carried out iteratively by optimizing the factor matrices to minimize the reconstruction error of the tensor.</p>
<p>Tucker decomposition is widely used in multi-dimensional data analysis, such as in signal processing, machine learning, and data compression. The algorithm efficiently reduces the dimensionality of the tensor while preserving its essential structure.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TensorType</td><td>The type representing the tensor, typically a multi-dimensional array with additional properties. </td></tr>
    <tr><td class="paramname">OptimizerType</td><td>The type of the optimizer used to handle the allocation of memory, initialization of partitions, and management of tensor dimensions. </td></tr>
    <tr><td class="paramname">SchedulerType</td><td>The type of the scheduler that manages task distribution. The scheduler organizes tensor blocks into tasks, which are then processed in an optimized order. </td></tr>
    <tr><td class="paramname">TensorManagerType</td><td>The type of the manager responsible for I/O operations, such as reading/writing factor matrices and handling intermediate data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>Pointer to the tensor object to be decomposed. This tensor contains the multi-dimensional data to be decomposed into a core tensor and factor matrices. </td></tr>
    <tr><td class="paramname">optimizer</td><td>Pointer to the optimizer object that is responsible for updating the factor matrices and managing the tensor's memory during the decomposition process. The optimizer also determines partitioning parameters and block dimensions. </td></tr>
    <tr><td class="paramname">scheduler</td><td>Pointer to the scheduler object that manages the scheduling of tasks during the decomposition process. The scheduler organizes blocks of the tensor based on their non-zero elements, ensuring that tasks are processed in a way that optimizes computational efficiency. </td></tr>
    <tr><td class="paramname">manager</td><td>Pointer to the tensor manager object responsible for handling tensor-related operations, such as saving and loading factor matrices, managing memory, and handling intermediate computations.</td></tr>
  </table>
  </dd>
</dl>
<p>The <code>TuckerDecomposition</code> function begins by initializing the factor matrices and the core tensor. Each factor matrix corresponds to one mode (dimension) of the tensor and is initialized with random values. The optimizer is responsible for determining the appropriate dimensions for the blocks and partitions within the tensor.</p>
<p>The core tensor is a smaller, dense tensor that captures the essential structure of the original tensor. It is initialized with random values and iteratively refined as the decomposition progresses.</p>
<p>The main loop of the function performs the Tucker decomposition by iteratively updating the factor matrices and the core tensor:</p>
<ol type="1">
<li><b>Factor Matrix Update</b>: The factor matrices are updated using the optimizer to minimize the reconstruction error. This involves solving optimization problems for each mode of the tensor.</li>
<li><b>Reconstruction and Fitness Calculation</b>: After updating the factor matrices, the tensor is reconstructed from the current factor matrices and core tensor. The fitness of the decomposition is calculated by comparing the reconstructed tensor to the original tensor. The fitness value provides a measure of how well the decomposition approximates the original tensor.</li>
</ol>
<p>The decomposition process continues until the fitness value converges (i.e., the change in fitness between iterations falls below a certain threshold) or until a maximum number of iterations is reached.</p>
<p>The scheduler plays a crucial role in organizing the tasks (blocks) that need to be processed, ensuring that the decomposition is performed efficiently. The tasks are sorted based on the number of non-zero elements in each block, and the scheduler manages the order in which these tasks are executed.</p>
<p>Finally, the resulting factor matrices and core tensor are written to files using the tensor manager. Intermediate data structures, such as error terms and temporary matrices, are allocated and deallocated as needed.</p>
<dl class="section note"><dt>Note</dt><dd>The function uses OpenMP for parallelization, allowing it to efficiently handle large tensors by distributing the work across multiple threads.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>OptimizerType, SchedulerType, TensorManagerType </dd></dl>

<p class="definition">Definition at line <a class="el" href="tucker_8hpp_source.html#l00082">82</a> of file <a class="el" href="tucker_8hpp_source.html">tucker.hpp</a>.</p>

</div>
</div>
<a id="a961d8373cec8a3b70e61251f368b980b" name="a961d8373cec8a3b70e61251f368b980b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a961d8373cec8a3b70e61251f368b980b">&#9670;&#160;</a></span>UpdateFactorMatrices()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TensorType , typename MatrixType , typename ValueType , typename SchedulerType , typename <a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void supertensor::cputucker::UpdateFactorMatrices </td>
          <td>(</td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorType *</td>          <td class="paramname"><span class="paramname"><em>core_tensor</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ValueType ***</td>          <td class="paramname"><span class="paramname"><em>factor_matrices</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType **</td>          <td class="paramname"><span class="paramname"><em>B</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MatrixType **</td>          <td class="paramname"><span class="paramname"><em>C</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>rank</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SchedulerType *</td>          <td class="paramname"><span class="paramname"><em>scheduler</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html">TensorManager</a> *</td>          <td class="paramname"><span class="paramname"><em>manager</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the factor matrices using row-wise update rule in Tucker decomposition. </p>
<p>This function performs the update of the factor matrices using row-wise update rule for the given tensor as part of the Tucker decomposition process. It utilizes the delta vectors, the B vectors and C matrices computed by the ComputingDelta and the <code>ComputingBC</code> function to solve the optimization problem and update the factor matrices for each mode of the tensor.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">TensorType</td><td>The type representing the tensor, typically a multi-dimensional array with additional properties. </td></tr>
    <tr><td class="paramname">MatrixType</td><td>The type representing the matrix, used for the B and C matrices. </td></tr>
    <tr><td class="paramname">ValueType</td><td>The type representing the values stored in the delta. </td></tr>
    <tr><td class="paramname">SchedulerType</td><td>The type of the scheduler that manages task distribution and parallel execution. </td></tr>
    <tr><td class="paramname"><a class="el" href="classsupertensor_1_1cputucker_1_1_tensor_manager.html" title="The TensorManager class manages tensor data and performs I/O operations.">TensorManager</a></td><td>The type of the manager responsible for I/O operations, such as reading/writing factor matrices and handling intermediate data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>Pointer to the tensor object being decomposed. </td></tr>
    <tr><td class="paramname">core_tensor</td><td>Pointer to the core tensor object used in the decomposition process. </td></tr>
    <tr><td class="paramname">factor_matrices</td><td>Pointer to the array of factor matrices that will be updated. </td></tr>
    <tr><td class="paramname">B</td><td>Pointer to the B vectors array, which have been computed and are used in the update. </td></tr>
    <tr><td class="paramname">C</td><td>Pointer to the C matrices array, which have been computed and are used in the update. </td></tr>
    <tr><td class="paramname">rank</td><td>The rank used in the decomposition, determining the size of the matrices. </td></tr>
    <tr><td class="paramname">scheduler</td><td>Pointer to the scheduler object that manages the scheduling of tasks during the decomposition process. </td></tr>
    <tr><td class="paramname">manager</td><td>Pointer to the tensor manager object responsible for handling tensor-related operations, such as managing memory and performing I/O.</td></tr>
  </table>
  </dd>
</dl>
<p>The function iterates over each mode of the tensor (each factor matrix), performing the following steps:</p>
<ol type="1">
<li><b>Computing Delta</b>: Calls the <code>ComputingDelta</code> function to compute delta matrices needed for the B and C matrices.</li>
<li><b>Computing B and C Matrices</b>: Calls the <code>ComputingBC</code> function to compute the B and C matrices.</li>
<li><b>Factor Matrix Update</b>: Updates the factor matrices using B vectors, and C matrices computed in the previous steps.</li>
</ol>
<p>The update process is performed in parallel using OpenMP, which ensures efficient computation across multiple threads. Each row of the factor matrices is updated by inverting the B matrix and applying it to the C vectors. </p>

<p class="definition">Definition at line <a class="el" href="update_8hpp_source.html#l00147">147</a> of file <a class="el" href="update_8hpp_source.html">update.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacesupertensor.html">supertensor</a></li><li class="navelem"><a class="el" href="namespacesupertensor_1_1cputucker.html">cputucker</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
